<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Dashboard | Purely</title>
    <link rel="stylesheet" href="css/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        // Check if Supabase loaded
        if (typeof window.supabase === 'undefined') {
            console.error('‚ö†Ô∏è  Supabase library did not load from CDN, will retry');
            // Fallback - try loading from a different CDN
            var script = document.createElement('script');
            script.src = 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.0.0/dist/main.min.js';
            script.onload = function() { console.log('‚úì Supabase library loaded from fallback CDN'); };
            script.onerror = function() { console.error('‚úó Failed to load Supabase library from all CDNs'); };
            document.head.appendChild(script);
        } else {
            console.log('‚úì Supabase library loaded immediately');
        }
    </script>
    <script type="module" src="js/supabase-config.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #f5f7fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .admin-container {
            display: grid;
            grid-template-columns: 250px 1fr;
            min-height: 100vh;
            width: 100%;
        }

        .admin-sidebar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px 20px;
            position: fixed;
            left: 0;
            top: 0;
            height: 100vh;
            width: 250px;
            overflow-y: auto;
            z-index: 1000;
        }

        .admin-logo {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            white-space: normal;
        }

        .admin-menu {
            list-style: none;
        }

        .admin-menu li {
            margin-bottom: 10px;
        }

        .admin-menu button {
            width: 100%;
            text-align: left;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.3s;
            font-size: 0.95rem;
            white-space: normal;
            word-wrap: break-word;
        }

        .admin-menu button:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(5px);
        }

        .admin-menu button.active {
            background: white;
            color: #667eea;
            font-weight: 600;
        }

        .menu-btn {
            width: 100%;
            text-align: left;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.3s;
            font-size: 0.95rem;
        }

        .menu-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(5px);
        }

        .menu-btn.active {
            background: white;
            color: #667eea;
            font-weight: 600;
        }

        .admin-logout {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }

        .logout-btn {
            width: 100%;
            padding: 12px 15px;
            background: #ff4757;
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 6px;
            font-weight: 600;
            transition: background 0.3s;
        }

        .logout-btn:hover {
            background: #ff3838;
        }

        .admin-main {
            margin-left: 250px;
            padding: 30px;
            min-height: 100vh;
            background: #f5f7fa;
        }

        .section {
            display: none;
            width: 100%;
            box-sizing: border-box;
        }

        .section.active {
            display: block;
            width: 100%;
            box-sizing: border-box;
        }

        .section-title {
            color: #333;
            font-size: 2rem;
            margin-bottom: 25px;
            white-space: nowrap;
            display: block;
            line-height: 1.3;
            max-width: 100%;
            overflow: visible;
        }

        /* Overview Stats */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 0.9rem;
        }

        /* Tables */
        .data-table {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .table-header {
            padding: 20px;
            border-bottom: 2px solid #f0f0f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .table-header h3 {
            color: #333;
        }

        .add-btn {
            background: #667eea;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
        }

        .add-btn:hover {
            background: #764ba2;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            background: #f8f9fa;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: #333;
            border-bottom: 1px solid #eee;
        }

        td {
            padding: 15px;
            border-bottom: 1px solid #eee;
            color: #555;
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:hover {
            background: #f8f9fa;
        }

        /* Status Badges */
        .status-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-confirmed {
            background: #d1ecf1;
            color: #0c5460;
        }

        .status-shipped {
            background: #d1ecf1;
            color: #0c5460;
        }

        .status-delivered {
            background: #d4edda;
            color: #155724;
        }

        /* Action Buttons */
        .action-btn {
            padding: 6px 12px;
            margin: 0 3px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s;
        }

        .edit-btn {
            background: #667eea;
            color: white;
        }

        .edit-btn:hover {
            background: #764ba2;
        }

        .delete-btn {
            background: #ff4757;
            color: white;
        }

        .delete-btn:hover {
            background: #ff3838;
        }

        .view-btn {
            background: #2ed573;
            color: white;
        }

        .view-btn:hover {
            background: #26de81;
        }

        /* Forms */
        .form-container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            width: 100%;
            margin-bottom: 30px;
            box-sizing: border-box;
        }

        .form-group {
            margin-bottom: 20px;
            width: 100%;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 600;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 1rem;
            box-sizing: border-box;
            font-family: inherit;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
            white-space: normal;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 5px rgba(102, 126, 234, 0.3);
        }

        .submit-btn {
            background: #667eea;
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
        }

        .submit-btn:hover {
            background: #764ba2;
        }

        /* Charts */
        .chart-container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .chart-title {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        @media (max-width: 768px) {
            .admin-container {
                grid-template-columns: 1fr;
            }

            .admin-sidebar {
                position: relative;
                width: 100%;
                height: auto;
                min-height: auto;
            }

            .admin-main {
                margin-left: 0;
                padding: 20px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar -->
        <div class="admin-sidebar">
            <div class="admin-logo">üìä Purely Admin</div>
            <ul class="admin-menu">
                <li><button class="menu-btn active" onclick="switchAdminSection('overview', this)">üìà Dashboard</button></li>
                <li><button class="menu-btn" onclick="switchAdminSection('orders', this)">üì¶ Manage Orders</button></li>
                <li><button class="menu-btn" onclick="switchAdminSection('products', this)">üõçÔ∏è Manage Products</button></li>
                <li><button class="menu-btn" onclick="switchAdminSection('customers', this)">üë• Manage Customers</button></li>
                <li><button class="menu-btn" onclick="switchAdminSection('analytics', this)">üìä Analytics</button></li>
                <li><button class="menu-btn" onclick="switchAdminSection('settings', this)">‚öôÔ∏è Settings</button></li>
            </ul>
            <div class="admin-logout">
                <button class="logout-btn" onclick="adminLogout()">Logout</button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="admin-main">
            <!-- Overview Section -->
            <div id="overview" class="section active">
                <h2 class="section-title">Dashboard Overview</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üì¶</div>
                        <div class="stat-number" id="total-orders">0</div>
                        <div class="stat-label">Total Orders</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üí∞</div>
                        <div class="stat-number" id="total-revenue">$0</div>
                        <div class="stat-label">Total Revenue</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üë•</div>
                        <div class="stat-number" id="total-customers">0</div>
                        <div class="stat-label">Total Customers</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üõçÔ∏è</div>
                        <div class="stat-number" id="total-products">0</div>
                        <div class="stat-label">Total Products</div>
                    </div>
                </div>

                <div class="data-table">
                    <div class="table-header">
                        <h3>Recent Orders</h3>
                    </div>
                    <div id="recent-orders-table"></div>
                </div>
            </div>

            <!-- Orders Section -->
            <div id="orders" class="section">
                <h2 class="section-title">Manage Orders</h2>
                <div class="data-table">
                    <div class="table-header">
                        <h3>All Orders</h3>
                    </div>
                    <div id="orders-table"></div>
                </div>
            </div>

            <!-- Products Section -->
            <div id="products" class="section">
                <h2 class="section-title">Manage Products</h2>
                
                <div class="form-container">
                    <h3 style="margin-bottom: 20px;">Add New Product</h3>
                    <form onsubmit="addProductClick(event)">
                        <div class="form-group">
                            <label>Product Name</label>
                            <input type="text" id="product-name" required placeholder="Enter product name">
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <textarea id="product-desc" required placeholder="Enter description"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Price ($)</label>
                            <input type="number" id="product-price" step="0.01" required placeholder="Enter price">
                        </div>
                        <div class="form-group">
                            <label>Image URL</label>
                            <input type="url" id="product-image" placeholder="Enter image URL">
                        </div>
                        <button type="submit" class="submit-btn">Add Product</button>
                    </form>
                </div>

                <div class="data-table">
                    <div class="table-header">
                        <h3>All Products</h3>
                    </div>
                    <div id="products-table"></div>
                </div>
            </div>

            <!-- Customers Section -->
            <div id="customers" class="section">
                <h2 class="section-title">Manage Customers</h2>
                <div class="data-table">
                    <div class="table-header">
                        <h3>All Customers</h3>
                    </div>
                    <div id="customers-table"></div>
                </div>
            </div>

            <!-- Analytics Section -->
            <div id="analytics" class="section">
                <h2 class="section-title">Analytics & Reports</h2>
                
                <div class="chart-container">
                    <div class="chart-title">Sales This Month</div>
                    <div id="sales-chart"></div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">Top Selling Products</div>
                    <div id="top-products-chart"></div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">Customer Growth</div>
                    <div id="customer-chart"></div>
                </div>
            </div>

            <!-- Settings Section -->
            <div id="settings" class="section">
                <h2 class="section-title">Admin Settings</h2>
                
                <div class="form-container">
                    <h3 style="margin-bottom: 20px;">Store Settings</h3>
                    <form onsubmit="updateSettings(event)">
                        <div class="form-group">
                            <label>Store Name</label>
                            <input type="text" id="store-name" value="Purely" required>
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="store-email" value="support@purely.com" required>
                        </div>
                        <div class="form-group">
                            <label>Phone</label>
                            <input type="tel" id="store-phone" value="+1-800-PURELY" required>
                        </div>
                        <div class="form-group">
                            <label>Address</label>
                            <textarea id="store-address" required>123 Fashion Street, NY</textarea>
                        </div>
                        <button type="submit" class="submit-btn">Save Settings</button>
                    </form>
                </div>

                <div class="form-container">
                    <h3 style="margin-bottom: 20px;">Change Admin Password</h3>
                    <form onsubmit="changePassword(event)">
                        <div class="form-group">
                            <label>Current Password</label>
                            <input type="password" id="current-password" required>
                        </div>
                        <div class="form-group">
                            <label>New Password</label>
                            <input type="password" id="new-password" required>
                        </div>
                        <div class="form-group">
                            <label>Confirm Password</label>
                            <input type="password" id="confirm-password" required>
                        </div>
                        <button type="submit" class="submit-btn">Update Password</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase-helpers.js"></script>
    <script>
        let currentAdmin = null;
        let productsData = [];

        document.addEventListener('DOMContentLoaded', () => {
            const admin = JSON.parse(localStorage.getItem('purely_admin_user'));
            if (!admin) {
                window.location.href = 'admin-login.html';
                return;
            }
            currentAdmin = admin;
            loadDashboardData();
        });

        function switchAdminSection(section, element) {
            document.querySelectorAll('.section').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.menu-btn').forEach(el => el.classList.remove('active'));
            
            const sectionEl = document.getElementById(section);
            if (sectionEl) {
                sectionEl.classList.add('active');
            }
            
            if (element) {
                element.classList.add('active');
            }

            if (section === 'overview') loadDashboardData();
            else if (section === 'orders') loadOrders();
            else if (section === 'products') loadProducts();
            else if (section === 'customers') loadCustomers();
            else if (section === 'analytics') loadAnalytics();
        }

        function loadDashboardData() {
            const orders = JSON.parse(localStorage.getItem('purely_orders') || '[]');
            const users = JSON.parse(localStorage.getItem('purely_users') || '[]');
            const products = JSON.parse(localStorage.getItem('purely_products') || '[]');

            const totalRevenue = orders.reduce((sum, order) => sum + parseFloat(order.total || 0), 0);

            document.getElementById('total-orders').textContent = orders.length;
            document.getElementById('total-revenue').textContent = '$' + totalRevenue.toFixed(2);
            document.getElementById('total-customers').textContent = users.length;
            document.getElementById('total-products').textContent = products.length;

            const recentOrders = orders.slice(-5).reverse();
            const table = document.getElementById('recent-orders-table');
            
            if (recentOrders.length === 0) {
                table.innerHTML = '<div class="empty-state"><div class="empty-state-icon">üì≠</div><p>No orders yet</p></div>';
                return;
            }

            table.innerHTML = `
                <table>
                    <thead>
                        <tr>
                            <th>Order ID</th>
                            <th>Customer</th>
                            <th>Amount</th>
                            <th>Status</th>
                            <th>Date</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${recentOrders.map(order => `
                            <tr>
                                <td>${order.id}</td>
                                <td>${order.customerId ? 'Customer #' + order.customerId : 'Guest'}</td>
                                <td>$${order.total}</td>
                                <td><span class="status-badge status-${order.status.toLowerCase()}">${order.status}</span></td>
                                <td>${new Date(order.date).toLocaleDateString()}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function loadOrders() {
            const orders = JSON.parse(localStorage.getItem('purely_orders') || '[]');
            const table = document.getElementById('orders-table');

            if (orders.length === 0) {
                table.innerHTML = '<div class="empty-state"><div class="empty-state-icon">üì≠</div><p>No orders yet</p></div>';
                return;
            }

            table.innerHTML = `
                <table>
                    <thead>
                        <tr>
                            <th>Order ID</th>
                            <th>Amount</th>
                            <th>Items</th>
                            <th>Status</th>
                            <th>Date</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${orders.map(order => `
                            <tr>
                                <td>${order.id}</td>
                                <td>$${order.total}</td>
                                <td>${order.items.length}</td>
                                <td>
                                    <select onchange="updateOrderStatus('${order.id}', this.value)" class="status-badge status-${order.status.toLowerCase()}">
                                        <option value="Pending" ${order.status === 'Pending' ? 'selected' : ''}>Pending</option>
                                        <option value="Confirmed" ${order.status === 'Confirmed' ? 'selected' : ''}>Confirmed</option>
                                        <option value="Shipped" ${order.status === 'Shipped' ? 'selected' : ''}>Shipped</option>
                                        <option value="Delivered" ${order.status === 'Delivered' ? 'selected' : ''}>Delivered</option>
                                    </select>
                                </td>
                                <td>${new Date(order.date).toLocaleDateString()}</td>
                                <td>
                                    <button class="action-btn view-btn" onclick="viewOrderDetails('${order.id}')">View</button>
                                    <button class="action-btn delete-btn" onclick="deleteOrder('${order.id}')">Delete</button>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function updateOrderStatus(orderId, newStatus) {
            const orders = JSON.parse(localStorage.getItem('purely_orders') || '[]');
            const order = orders.find(o => o.id === orderId);
            if (order) {
                order.status = newStatus;
                localStorage.setItem('purely_orders', JSON.stringify(orders));
                alert('Order status updated to: ' + newStatus);
                loadOrders();
            }
        }

        function deleteOrder(orderId) {
            if (confirm('Are you sure you want to delete this order?')) {
                const orders = JSON.parse(localStorage.getItem('purely_orders') || '[]');
                const filtered = orders.filter(o => o.id !== orderId);
                localStorage.setItem('purely_orders', JSON.stringify(filtered));
                loadOrders();
            }
        }

        function viewOrderDetails(orderId) {
            const orders = JSON.parse(localStorage.getItem('purely_orders') || '[]');
            const order = orders.find(o => o.id === orderId);
            if (order) {
                const address = order.shippingAddress ? `\n\nShipping Address:\n${order.shippingAddress.firstName} ${order.shippingAddress.lastName}\n${order.shippingAddress.address}\n${order.shippingAddress.city}, ${order.shippingAddress.state} ${order.shippingAddress.zipcode}\n${order.shippingAddress.country}\nPhone: ${order.shippingAddress.phone}\nEmail: ${order.shippingAddress.email}` : '';
                alert(`Order Details:\n\nID: ${order.id}\nTotal: $${order.total}\nItems: ${order.items.length}\nStatus: ${order.status}\nDate: ${new Date(order.date).toLocaleDateString()}${address}`);
            }
        }

        async function loadProducts() {
            productsData = await fetchProducts();
            const table = document.getElementById('products-table');

            if (productsData.length === 0) {
                table.innerHTML = '<div class="empty-state"><div class="empty-state-icon">üõçÔ∏è</div><p>No products yet</p></div>';
                return;
            }

            table.innerHTML = `
                <table>
                    <thead>
                        <tr>
                            <th>Product Name</th>
                            <th>Price</th>
                            <th>Description</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${productsData.map((p, idx) => `
                            <tr>
                                <td>${p.name}</td>
                                <td>$${p.price}</td>
                                <td>${p.description.substring(0, 30)}...</td>
                                <td>
                                    <button class="action-btn edit-btn" onclick="editProduct(${idx})">Edit</button>
                                    <button class="action-btn delete-btn" onclick="deleteProductClick(${idx})">Delete</button>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        async function addProductClick(e) {
            e.preventDefault();
            const productData = {
                name: document.getElementById('product-name').value,
                description: document.getElementById('product-desc').value,
                price: parseFloat(document.getElementById('product-price').value),
                image: document.getElementById('product-image').value || 'https://via.placeholder.com/400'
            };

            const result = await addProduct(productData);
            
            if (result.success) {
                alert('Product added successfully!');
                document.querySelector('#products form').reset();
                loadProducts();
            } else {
                alert('Error adding product: ' + result.error);
            }
        }

        async function deleteProductClick(idx) {
            if (confirm('Delete this product?')) {
                const productId = productsData[idx].id;
                const result = await deleteProduct(productId);
                
                if (result.success) {
                    loadProducts();
                } else {
                    alert('Error deleting product: ' + result.error);
                }
            }
        }

        function loadCustomers() {
            const users = JSON.parse(localStorage.getItem('purely_users') || '[]');
            const table = document.getElementById('customers-table');

            if (users.length === 0) {
                table.innerHTML = '<div class="empty-state"><div class="empty-state-icon">üë•</div><p>No customers yet</p></div>';
                return;
            }

            table.innerHTML = `
                <table>
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Phone</th>
                            <th>Member Since</th>
                            <th>Orders</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${users.map(user => {
                            const orders = JSON.parse(localStorage.getItem('purely_orders') || '[]').filter(o => o.customerId === user.id);
                            return `
                            <tr>
                                <td>${user.name}</td>
                                <td>${user.email}</td>
                                <td>${user.phone}</td>
                                <td>${new Date(user.createdAt).toLocaleDateString()}</td>
                                <td>${orders.length}</td>
                            </tr>
                        `}).join('')}
                    </tbody>
                </table>
            `;
        }

        function loadAnalytics() {
            const orders = JSON.parse(localStorage.getItem('purely_orders') || '[]');
            const totalRevenue = orders.reduce((sum, o) => sum + parseFloat(o.total || 0), 0);
            const avgOrder = orders.length > 0 ? (totalRevenue / orders.length).toFixed(2) : 0;

            document.getElementById('sales-chart').innerHTML = `
                <div style="padding: 20px; background: #f8f9fa; border-radius: 8px;">
                    <p><strong>Total Revenue:</strong> $${totalRevenue.toFixed(2)}</p>
                    <p><strong>Total Orders:</strong> ${orders.length}</p>
                    <p><strong>Average Order Value:</strong> $${avgOrder}</p>
                </div>
            `;

            document.getElementById('top-products-chart').innerHTML = `
                <div style="padding: 20px; background: #f8f9fa; border-radius: 8px;">
                    <p>Top products data would display here</p>
                    <p>Track product performance by analyzing order data</p>
                </div>
            `;

            document.getElementById('customer-chart').innerHTML = `
                <div style="padding: 20px; background: #f8f9fa; border-radius: 8px;">
                    <p><strong>Total Customers:</strong> ${JSON.parse(localStorage.getItem('purely_users') || '[]').length}</p>
                    <p>Customer growth trends display here</p>
                </div>
            `;
        }

        function updateSettings(e) {
            e.preventDefault();
            const settings = {
                storeName: document.getElementById('store-name').value,
                email: document.getElementById('store-email').value,
                phone: document.getElementById('store-phone').value,
                address: document.getElementById('store-address').value
            };
            localStorage.setItem('purely_settings', JSON.stringify(settings));
            alert('Settings updated successfully!');
        }

        function changePassword(e) {
            e.preventDefault();
            const currentPass = document.getElementById('current-password').value;
            const newPass = document.getElementById('new-password').value;
            const confirmPass = document.getElementById('confirm-password').value;

            if (currentPass !== currentAdmin.password) {
                alert('Current password is incorrect');
                return;
            }

            if (newPass !== confirmPass) {
                alert('New passwords do not match');
                return;
            }

            const admins = JSON.parse(localStorage.getItem('purely_admins') || '[]');
            const adminIdx = admins.findIndex(a => a.id === currentAdmin.id);
            admins[adminIdx].password = newPass;
            localStorage.setItem('purely_admins', JSON.stringify(admins));

            alert('Password changed successfully!');
            document.querySelector('#settings form:last-of-type').reset();
        }

        function adminLogout() {
            localStorage.removeItem('purely_admin_user');
            window.location.href = 'admin-login.html';
        }
    </script>
</body>
</html>
